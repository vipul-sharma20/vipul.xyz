<div style="text-align: center">
  <img src="{{ include.url }}" alt="{{ include.alt }}" style="width:{{ include.size }}px; border:1px solid #000; cursor: pointer;" onclick="openModal(this)" />
  <p style="text-align:center;padding:5px;font-size:0.7em;margin-top:5px;margin-left:25px;margin-right:15px">{{ include.caption }}</p>
</div>

<!-- Modal Structure -->
<div id="imageModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.8); align-items: center; justify-content: center; z-index: 1000;" onclick="closeModal(event)">
  <span onclick="closeModal(event)" style="position: absolute; top: 20px; right: 30px; color: white; font-size: 35px; font-weight: bold; cursor: pointer;">&times;</span>
  <img id="modalImage" style="max-width: 90%; max-height: 90%;" />
</div>

<script>
  function openModal(img) {
    const modal = document.getElementById('imageModal');
    const modalImg = document.getElementById('modalImage');
    modal.style.display = 'flex';
    modalImg.src = img.src;
  }

  function closeModal(event) {
    const modal = document.getElementById('imageModal');
    // Close only if clicked outside the image or on the close button
    if (event.target === modal || event.target.tagName === 'SPAN') {
      modal.style.display = 'none';
    }
  }

  // Close modal on escape key press
  document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
      closeModal({ target: document.getElementById('imageModal') });
    }
  });
</script>

