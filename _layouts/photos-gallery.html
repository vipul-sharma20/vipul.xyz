---
layout: default
---

<link rel="stylesheet" href="{{ '/assets/css/gallery.css' | relative_url }}">

{% if page.header.overlay_color or page.header.overlay_image or page.header.image %}
  {% include page__hero.html %}
{% elsif page.header.video.id and page.header.video.provider %}
  {% include page__hero_video.html %}
{% endif %}

{% if page.url != "/" and site.breadcrumbs %}
  {% unless paginator %}
    {% include breadcrumbs.html %}
  {% endunless %}
{% endif %}

<div id="main" role="main">
  <article class="page gallery-full-width" itemscope itemtype="https://schema.org/CreativeWork">
    {% if page.title %}<meta itemprop="headline" content="{{ page.title | markdownify | strip_html | strip_newlines | escape_once }}">{% endif %}
    {% if page.excerpt %}<meta itemprop="description" content="{{ page.excerpt | markdownify | strip_html | strip_newlines | escape_once }}">{% endif %}

    <div class="page__inner-wrap">
      {% unless page.header.overlay_color or page.header.overlay_image %}
        <header>
          {% if page.title %}<h1 id="page-title" class="page__title" itemprop="headline">{{ page.title | markdownify | remove: "<p>" | remove: "</p>" }}</h1>{% endif %}
        </header>
      {% endunless %}

      <section class="page__content" itemprop="text">
        {{ content }}

        <!-- Tag Filter Controls -->
        <div class="gallery-filter-controls">
          <div class="filter-tags">
            {% assign all_tags = site.photos | map: "tags" | join: "," | split: "," | uniq | sort %}
            {% for tag in all_tags %}
              {% unless tag == "" %}
                <span class="tag-pill" data-filter="{{ tag }}">
                  {{ tag }}
                </span>
              {% endunless %}
            {% endfor %}
          </div>
        </div>

        <!-- Photo Gallery Grid -->
        <div class="photo-gallery-grid">
          {% assign photos_by_date = site.photos | sort: 'date' | reverse %}
          {% assign current_year = '' %}
          {% assign current_month = '' %}
          
          {% for photo in photos_by_date %}
            {% assign photo_year = photo.date | date: '%Y' %}
            {% assign photo_month = photo.date | date: '%B %Y' %}
            
            {% if current_month != photo_month %}
              {% unless current_month == '' %}
                </div> <!-- Close previous month section -->
              {% endunless %}
              <div class="gallery-month-section">
                <h3 class="gallery-month-divider">{{ photo_month }}</h3>
                <div class="gallery-month-photos">
            {% endif %}
            
            <div class="photo-grid-item" 
                 data-tags="{{ photo.tags | join: ' ' }}"
                 data-date="{{ photo.date | date: '%Y-%m-%d' }}">
              <a href="{{ photo.url | relative_url }}" class="photo-link">
                <div class="photo-thumbnail">
                  <img src="{{ photo.image | relative_url }}" 
                       alt="{{ photo.title }}" 
                       loading="lazy">
                  {% if photo.excerpt %}
                  <div class="photo-overlay">
                    <p class="photo-excerpt">{{ photo.excerpt }}</p>
                  </div>
                  {% endif %}
                </div>
              </a>
            </div>
            
            {% assign current_month = photo_month %}
            {% if forloop.last %}
              </div> <!-- Close month photos -->
              </div> <!-- Close month section -->
            {% endif %}
          {% endfor %}
        </div>
      </section>
    </div>
  </article>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const tagFilters = document.querySelectorAll('.tag-pill');
  const photoItems = document.querySelectorAll('.photo-grid-item');
  const monthSections = document.querySelectorAll('.gallery-month-section');

  // Handle tag pill clicks
  tagFilters.forEach(tag => {
    tag.addEventListener('click', function() {
      this.classList.toggle('active');
      filterPhotos();
    });
  });

  function getSelectedTags() {
    return Array.from(tagFilters)
      .filter(tag => tag.classList.contains('active'))
      .map(tag => tag.dataset.filter);
  }

  function filterPhotos() {
    const selectedTags = getSelectedTags();
    
    if (selectedTags.length === 0) {
      showAllPhotos();
      return;
    }

    // Show photos that match ANY of the selected tags (OR condition)
    photoItems.forEach(item => {
      const dataTagsAttr = item.getAttribute('data-tags');
      let hasMatchingTag = false;
      
      // Check if any selected tag appears in the data-tags attribute
      for (let selectedTag of selectedTags) {
        if (dataTagsAttr.includes(selectedTag)) {
          hasMatchingTag = true;
          break;
        }
      }
      
      if (hasMatchingTag) {
        item.style.display = 'block';
        item.style.opacity = '1';
      } else {
        item.style.display = 'none';
        item.style.opacity = '0';
      }
    });

    hideEmptyMonthSections();
  }

  function showAllPhotos() {
    photoItems.forEach(item => {
      item.style.display = 'block';
      item.style.opacity = '1';
    });
    
    monthSections.forEach(section => {
      section.style.display = 'block';
    });
  }

  function hideEmptyMonthSections() {
    monthSections.forEach(section => {
      const visiblePhotos = section.querySelectorAll('.photo-grid-item:not([style*="display: none"])');
      section.style.display = visiblePhotos.length === 0 ? 'none' : 'block';
    });
  }

  // Initialize - no filter state needed
});
</script>